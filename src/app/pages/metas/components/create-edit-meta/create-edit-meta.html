<div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 max-w-lg w-full shadow-2xl">
  <div class="flex justify-between items-center mb-6">
    <h2 class="text-2xl font-bold">{{ isEditMode ? 'Editar Meta' : 'Nueva Meta' }}</h2>
    <button (click)="closeModal()" class="text-white/70 hover:text-white text-2xl">&times;</button>
  </div>

  <div class="max-h-[70vh] overflow-y-auto pr-2">
    <form [formGroup]="metaForm" (ngSubmit)="onSubmit()" class="space-y-4">
      <div>
        <label class="block text-sm font-medium mb-2">Título *</label>
        <input
          type="text"
          formControlName="titulo"
          class="w-full px-4 py-2 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30 focus:outline-none focus:border-white/50"
          placeholder="Ej: Viajar a París"
        />
        @if (submitted && f['titulo'].errors) {
          <p class="text-red-300 text-xs mt-1">
            @if (f['titulo'].errors['required']) { El título es requerido }
            @if (f['titulo'].errors['maxlength']) { Máximo 200 caracteres }
          </p>
        }
      </div>

      <div>
        <label class="block text-sm font-medium mb-2">Descripción</label>
        <textarea
          formControlName="descripcion"
          rows="3"
          class="w-full px-4 py-2 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30 focus:outline-none focus:border-white/50 resize-none"
          placeholder="Describe tu meta..."
        ></textarea>
      </div>

      @if (isEditMode) {
        <div>
          <label class="block text-sm font-medium mb-2">Progreso (%) *</label>
          <select
            formControlName="progreso"
            class="w-full px-4 py-2 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30 focus:outline-none focus:border-white/50"
          >
            @for (porcentaje of porcentajes; track porcentaje) {
              <option [value]="porcentaje">{{ porcentaje }}%</option>
            }
          </select>
          @if (submitted && f['progreso'].errors) {
            <p class="text-red-300 text-xs mt-1">
              @if (f['progreso'].errors['required']) { El progreso es requerido }
            </p>
          }
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Estado *</label>
          <select
            formControlName="estado"
            class="w-full px-4 py-2 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30 focus:outline-none focus:border-white/50"
          >
            @for (estado of estadoOptions; track estado.valor) {
              <option [value]="estado.valor">{{ estado.nombre }}</option>
            }
          </select>
          @if (submitted && f['estado'].errors) {
            <p class="text-red-300 text-xs mt-1">El estado es requerido</p>
          }
        </div>
      }

      <div class="flex gap-3 pt-4">
        <button
          type="button"
          (click)="closeModal()"
          class="flex-1 px-6 py-3 bg-white/10 rounded-lg hover:bg-white/20 transition-all"
        >
          Cancelar
        </button>
        <button
          type="submit"
          class="flex-1 px-6 py-3 bg-white text-purple-600 font-semibold rounded-lg hover:bg-white/90 transition-all"
        >
          {{ isEditMode ? 'Actualizar' : 'Crear' }}
        </button>
      </div>
    </form>
  </div>
</div>
